{% extends "base.html" %}
{% load static %}

{% block head %}
<!DOCTYPE html>
    <title>definition</title>
    <script src="{% static 'js/vue.min.js' %}"></script>
    <script src="{% static 'js/axios.min.js' %}">const axios = require('axios');</script>
    <script src="{% static 'js/vue-cookies.js' %}"></script>
{% endblock %}

{% block content %}
<div id="app">
    <div class="definition-content centering" style="color:#212121">
        <div>
            <span v-html="definitionHtml"></span>
        </div>
    </div>
    <div class="searchbar">
        <div class="centering">
            <form action="#">
                <input type="checkbox" v-model="noProcess"><label>full</label>
                <input type="text" v-model="word"/>
                <button @click="loadDef"><i class="fa fa-search"></i></button>
            </form>
        </div>
    </div>
</div>

<script>
    new Vue({
        delimiters: ['[[', ']]'],
        el: '#app',
        data: {
            definitionHtml: '',
            word: '',
            noProcess: true,
        },
        methods: {
            loadDef: function () {
                if (this.word != '') {
                axios
                  .post('/def/api/def/' + this.word,
                        {'no_process': this.noProcess},
                        {headers: {'X-CSRFToken': $cookies.get('csrftoken')}})
                  .then(response => (this.definitionHtml = response.data.htmlcontent))
                  .catch(error => this.printerr(error));
                }
            },
            test: function () {
                alert("a test ");
            },
            printerr: function (err_msg) {
                alert("ça a planté...\n\n" + err_msg);
            }
        },
        mounted() {
        }
    })

</script>
{% endblock %}

{% extends "base.html" %}
{% load static %}

{% block head %}
<!DOCTYPE html>
    <title>definition</title>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js">const axios = require('axios');</script>
{% endblock %}

{% block content %}
<div id="app">
    <div class="definition-content centering" style="color:#212121">
        <div class="article" v-for="article in data">
            <div class="word">[[ article.word ]]</div>
            <div class="bloc" v-for="bloc in article.blocs">
                <div class="definition">[[ formatDefinition(bloc.definition) ]]</div>
            </div>
            <br>
        </div>
    </div>
    <div class="searchbar">
        <div class="centering">
            <form action="#">
                <input type="text" v-model="word"/>
                <button @click="loadDef"><i class="fa fa-search"></i></button>
            </form>
        </div>
    </div>
</div>

<script>
    new Vue({
        delimiters: ['[[', ']]'],
        el: '#app',
        data: {
            data: '',
            word: '',
        },
        methods: {
            loadDef: function () {
                if (this.word != '') {
                axios
                  .get('/def/api/def/' + this.word)
                  .then(response => (this.data = response.data))
                  .catch(error => this.printerr(error));
                }
            },
            test: function () {
                alert("a test ");
            },
            printerr: function (err_msg) {
                alert("ça a planté...\n\n" + err_msg);
            },
            formatDefinition: function(words) {
                return words.join(" ");
            }
        },
        mounted() {
        }
    })

</script>
{% endblock %}
